<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/polymer/lib/elements/dom-repeat.html"><link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html"><link rel="import" href="../bower_components/app-layout/app-header/app-header.html"><link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html"><link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html"><link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html"><link rel="import" href="../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../bower_components/iron-image/iron-image.html"><link rel="import" href="../bower_components/paper-input/paper-input.html"><link rel="import" href="../bower_components/paper-button/paper-button.html"><link rel="import" href="ca-contact.html"></head><body><dom-module id="ca-webapp"><template><style>:host{--app-primary-color:orange;--app-secondary-color:black;display:block;}app-drawer-layout:not([narrow]) [drawer-toggle]{display:none;}app-header{color:#fff;background-color:var(--app-primary-color);}#content{max-width:800px;margin:0 auto;padding:20px 30px;background:white;}.contact-input{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-bottom:40px;}iron-image{width:250px;height:250px;border-radius:50%;border:1px solid grey;}.avatar-wrapper{position:relative;overflow:hidden;}.avatar-wrapper:hover .change-avatar-bg{opacity:0.8;background-color:grey;}.avatar-wrapper:hover .change-avatar-text{opacity:1;color:#FFF;font-size:40px;font-weight:bold;}.change-avatar-bg,
      .change-avatar-text{border-radius:50%;opacity:0;position:absolute;top:0;width:252px;height:252px;line-height:252px;text-align:center;}input[type=file]{font-size:252px;position:absolute;left:0;top:0;opacity:0;}input[type=file], /* FF, IE7+, chrome (except button) */
      input[type=file]::-webkit-file-upload-button{cursor:pointer;}paper-input,
      paper-button{width:300px;margin:10px 0px;}paper-button{background-color:orange;color:white;}.contact-list{display:flex;}</style><iron-ajax id="ajax" url="[[backendUrl]]ca-backend/api/1.1/tables/contacts/rows" content-type="application/json" method="GET" params="{&quot;depth&quot;:&quot;2&quot;}"></iron-ajax><iron-ajax id="uploadAjax" url="[[backendUrl]]ca-backend/api/1.1/tables/contacts/rows" content-type="application/json" method="POST"></iron-ajax><app-drawer-layout fullbleed="" narrow="{{narrow}}"><app-header-layout has-scrolling-region=""><app-header slot="header" condenses="" reveals="" effects="waterfall"><app-toolbar><paper-icon-button icon="my-icons:menu" drawer-toggle=""></paper-icon-button><div main-title="">Contact List Webapp</div></app-toolbar></app-header><div id="content"><div class="contact-input"><div class="avatar-wrapper"><iron-image src="[[fileBase64]]" placeholder="/images/htwg.png" sizing="contain" fade="" preload=""></iron-image><div><div class="change-avatar-bg"></div><div class="change-avatar-text">Ã„ndern</div><input id="fileInput" type="file" multiple="" accept="image/x-png,image/gif,image/jpeg,image/jpg" on-change="_fileChanged"></div></div><paper-input id="nameInput" label="Name" value="{{name}}" required=""></paper-input><paper-button on-click="_saveContact">save</paper-button></div><h2>Eingetragene Nutzer</h2><div class="contact-list"><template is="dom-repeat" items="{{contacts}}"><ca-contact name="[[item.name]]" img-path="[[backendUrl]][[item.image.data.url]]"></ca-contact></template></div></div></app-header-layout></app-drawer-layout></template><script>let defaultContacts=[{name:"Felix"},{name:"Georg"}];Polymer.setPassiveTouchGestures(!0);class CaWebapp extends Polymer.Element{static get is(){return"ca-webapp"}static get properties(){return{backendUrl:{type:String,value:window.location.protocol+"//"+window.location.hostname+"/"},contacts:Array,file:Object,fileBase64:String,name:String}}static get observers(){return[]}connectedCallback(){super.connectedCallback(),this.getContacts()}_fileChanged(a){let b=a.path[0].files[0];this.file=b;var c=new FileReader;c.readAsDataURL(b),c.onload=function(){this.fileBase64=c.result}.bind(this),c.onerror=function(a){console.log(a)}.bind(this)}_saveContact(){if(this.$.nameInput.validate()){let a=this.name,b=this.file,c=this.fileBase64,d=this.$.uploadAjax;d.body=b?{name:a,image:{charset:"binary",data:c,name:b.name,type:b.type}}:{name:a};let e=d.generateRequest();e.completes.then(()=>{this.name=void 0,this.file={},this.fileBase64="",this.getContacts()}).catch(()=>{console.log("Upload Error")})}}getContacts(){let a=this.$.ajax.generateRequest();a.completes.then((a)=>{this.contacts=a.response.data}).catch(()=>{console.log("Error"),this.contacts=defaultContacts})}}window.customElements.define(CaWebapp.is,CaWebapp);</script></dom-module></body></html>